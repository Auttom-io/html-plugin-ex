<!DOCTYPE html>
<html lang="en">

<head>
	<title>AS KASALLA - Browse our diverse fleet of Rental Cars in Albania! Choose from economy, luxury, and SUV
		vehicles with both manual and automatic transmission options, all meticulously maintained for your safety and
		comfort.</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- Favicon -->
	<link rel="icon" href="../images/favicon.ico" type="image/x-icon">

	<!-- SEO Keywords -->
	<meta name="description"
		content="A.S Kasalla Rental Car offers affordable and reliable car rentals in Tirana, Albania. Rent a car at Tirana Airport, explore Albania with our economy and family car rentals. Book your rental car online today!">
	<meta name="keywords"
		content="rent a car tirana, Tirana car rental, rent a car tirana airport, Discover Albania with A.S Kasalla Rental Car, AS Kasalla rental car, Affordable Car Rentals in Tirana Airport, economy car rental in tirana airport, rent a sedan in tirana, car hire in tirana, Explore Albania with rental cars, Car rental in Albania, Rental cars Albania, Online car booking, Albanian car hire, Car rentals in Durrës, Car rentals in DurrësVlora, Family car rentals, Business car rentals in tirana, Car rental deals">

	<!-- Google Tag Manager -->
	<script>(function (w, d, s, l, i) {
			w[l] = w[l] || []; w[l].push({
				'gtm.start':
					new Date().getTime(), event: 'gtm.js'
			}); var f = d.getElementsByTagName(s)[0],
				j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
					'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
		})(window, document, 'script', 'dataLayer', 'GTM-TMTJBTL3');</script>
	<!-- End Google Tag Manager -->

	<link href="https://fonts.googleapis.com/css?family=Poppins:200,300,400,500,600,700,800&display=swap"
		rel="stylesheet">
	<link rel="stylesheet" href="../css/open-iconic-bootstrap.min.css">
	<link rel="stylesheet" href="../css/animate.css">
	<link rel="stylesheet" href="../css/owl.carousel.min.css">
	<link rel="stylesheet" href="../css/owl.theme.default.min.css">
	<link rel="stylesheet" href="../css/magnific-popup.css">
	<link rel="stylesheet" href="../css/aos.css">
	<link rel="stylesheet" href="../css/ionicons.min.css">
	<link rel="stylesheet" href="../css/bootstrap-datepicker.css">
	<link rel="stylesheet" href="../css/jquery.timepicker.css">
	<link rel="stylesheet" href="../css/flaticon.css">
	<link rel="stylesheet" href="../css/icomoon.css">
	<link rel="stylesheet" href="../css/style.css">

</head>

<body>
	<!-- Google Tag Manager (noscript) -->
	<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TMTJBTL3" height="0" width="0"
			style="display:none;visibility:hidden"></iframe></noscript>
	<!-- End Google Tag Manager (noscript) -->

	<nav class="navbar navbar-expand-lg navbar-dark ftco_navbar bg-dark ftco-navbar-light" id="ftco-navbar">
		<div class="container">
			<a class="navbar-brand" href="index.html"><img src="../images/Vector (2).png" alt="ASKasalla Logo"
					class="logo"></a>
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#ftco-nav"
				aria-controls="ftco-nav" aria-expanded="false" aria-label="Toggle navigation">
				<span class="oi oi-menu"></span> Menu
			</button>

			<div class="collapse navbar-collapse" id="ftco-nav">
				<ul class="navbar-nav ml-auto">
					<li class="nav-item active"><a href="index.html" class="nav-link">Home</a></li>
					<li class="nav-item"><a href="about.html" class="nav-link">Chi siamo</a></li>
					<li class="nav-item"><a href="services.html" class="nav-link">Servizi</a></li>
					<li class="nav-item"><a href="car.html" class="nav-link">Auto</a></li>
					<li class="nav-item"><a href="blog.html" class="nav-link">Blog</a></li>
					<li class="nav-item"><a href="contact.html" class="nav-link">Contatti</a></li>
				</ul>
				<div style="display: flex;">
					<a href="../index.html" class="nav-link" style="margin-right: -10px;">
						<img src="https://cdn.britannica.com/44/344-050-94536674/Flag-England.jpg" width="25px"
							height="25px" style="border-radius: 50px;" />
					</a>
					<a href="index.html" class="nav-link" style="margin-left: -10px;">
						<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/03/Flag_of_Italy.svg/1500px-Flag_of_Italy.svg.png"
							width="25px" height="25px" style="border-radius: 50px;" />
					</a>
				</div>
			</div>
		</div>
	</nav>
	<!-- END nav -->

	<section class="ftco-section bg-light">
		<div class="container">

			<div class="row justify-content-center mb-5">
				<div class="col-md-7 text-center heading-section ftco-animate">
					<span class="subheading">Explore Our Rental Fleet</span>
					<h2 class="mb-3">Choose affordable Car Rental Rates</h2>
				</div>
			</div>

			<div id="car-rentals">

			</div>

			<!-- Modal Structure -->
			<div class="modal fade" id="bookNowModal" tabindex="-1" role="dialog" aria-labelledby="bookNowModalLabel"
				aria-hidden="true">
				<div class="modal-dialog" role="document">
					<div class="modal-content">
						<div class="modal-header">
							<h5 class="modal-title" id="bookNowModalLabel">
								Book This Car
							</h5>
							<button type="button" class="close" data-dismiss="modal" aria-label="Close">
								<span aria-hidden="true">&times;</span>
							</button>
						</div>
						<div class="modal-body">

							<div style="margin-bottom: 20px;">
								<div style="margin-left: 15px;">
									<h5>Vehicle Details</h5>
								</div>
								<div class="row">
									<div class="col-md-3">
										<img id="vehicle_img" width="100px" />
									</div>
									<div class="col-md-6">
										<h5 id="vehiclename"></h5>
										<p style="margin-top: -15px;" id="vehiclemodel"></p>
										<p style="margin-top: -15px; color: #222;" id="vehicleprice"></p>
									</div>
								</div>
							</div>

							<form id="bookingForm">
								<div class="row">
									<div class="col-md-6">
										<div class="form-group">
											<label for="pickupDate">Your name</label>
											<input type="text" class="form-control" id="full_name" name="full_name"
												placeholder="Enter your name" required />
										</div>
									</div>
									<div class="col-md-6">
										<div class="form-group">
											<label for="pickupDate">Your phone</label>
											<input type="number" class="form-control" id="phone_number"
												name="phone_number" placeholder="Phone number" maxlength="14"
												required />
										</div>
									</div>
									<div class="col-md-12">
										<div class="form-group">
											<label for="pickupDate">Email</label>
											<input type="email" class="form-control" id="email" name="email"
												placeholder="Enter your email" required />
										</div>
									</div>
									<div class="col-md-6">
										<div class="form-group">
											<label for="pickupDate">Pick-up Date</label>
											<input type="text" class="form-control" id="book_pick_date" value=""
												name="pickupDate" placeholder="Pickup date" required />
										</div>
									</div>
									<div class="col-md-6">
										<div class="form-group">
											<label for="dropoffDate">Drop-off Date</label>
											<input type="text" class="form-control" id="book_off_date" value=""
												name="dropoffDate" placeholder="Dropoff date" required />
										</div>
									</div>
									<!-- <div class="form-group">
									<label for="pickupTime">Pick-up Time</label>
									<input type="time" class="form-control" id="pickupTime" name="pickupTime"
										required />
								</div> -->
									<input type="number" class="form-control" id="pickupLocation" name="pickup_location"
										value="" hidden required />
									<input type="number" class="form-control" id="dropoffLocation"
										name="dropoff_location" hidden value="" required />

									<!-- vehicle details -->
									<input id="vehicle_id" name="vehicle_id" hidden />

									<input id="price" name="price" hidden />
									<div class="col-md-12">
										<button type="submit" class="btn"
											style="width: 100%; background-color: #141717; color: #fff; border-radius: 10px; margin-top: 10px;">Confirm
											Booking</button>
										<p style="font-size: 12px; text-align: end; color: #222;">Powered by <a
												href="https://www.auttom.io/solutions/car-rental-system"
												style="color: #ff5757;" target="_blank">auttom.io</a></p>
									</div>
								</div>
							</form>
							<div id="responseMessage" style="margin-top: 20px;">
							</div>
						</div>
					</div>
				</div>
			</div>

		</div>
	</section>

	<a href="https://wa.me/355692212906?text=Hello" target="_blank" class="whatsapp-button">
		<img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WhatsApp">
	  </a>

	<footer class="ftco-footer ftco-bg-dark ftco-section">
		<div class="container">
			<div class="row mb-5">
				<div class="col-md">
					<div class="ftco-footer-widget mb-4">
						<h2 class="ftco-heading-2"> <a class="navbar-brand" href="index.html"><img
									src="../images/Vector (2).png" alt="ASKasalla Logo" class="logo"></a></h2>
						<p>Discover Albania with rented car! Reliable, Affordable and 24/7 Car Rentals in Tirana
							Airport.</p>
						<ul class="ftco-footer-social list-unstyled float-md-left float-lft mt-5">
							<li class="ftco-animate"><a
									href="https://www.facebook.com/profile.php?id=61559937328724"><span
										class="icon-facebook"></span></a></li>
							<li class="ftco-animate"><a href="https://www.instagram.com/a.s_kasalla_rental_car/"><span
										class="icon-instagram"></span></a></li>
						</ul>
					</div>
				</div>
				<div class="col-md">
					<div class="ftco-footer-widget mb-4 ml-md-5">
						<h2 class="ftco-heading-2">Information</h2>
						<ul class="list-unstyled">
							<li><a href="about.html">About Us</a></li>
							<li><a href="services.html">Services</a></li>
							<li><a href="terms.html" class="py-2 d-block">Term and Conditions</a></li>
							<li><a href="terms.html" class="py-2 d-block">Privacy &amp; Cookies Policy</a></li>
						</ul>
					</div>
				</div>
				<div class="col-md">
					<div class="ftco-footer-widget mb-4">
						<h2 class="ftco-heading-2">Customer Support</h2>
						<ul class="list-unstyled">
							<li><a href="contact.html" class="py-2 d-block">FAQ</a></li>
							<li><a href="blog.html">Booking Tips</a></li>
							<li><a href="car.html">Our Fleet</a></li>
							<li><a href="contact.html">Contact Us</a></li>
						</ul>
					</div>
				</div>
				<div class="col-md">
					<div class="ftco-footer-widget mb-4">
						<h2 class="ftco-heading-2">Have a Questions?</h2>
						<div class="block-23 mb-3">
							<ul>
								<li><span class="icon icon-map-marker"></span><span class="text">Airport Street, Rinas,
										1504
										Albania</span></li>
								<li><a href="#"><span class="icon icon-phone"></span><span class="text">+355 69 221
											2906</span></a></li>
								<li><a href="#"><span class="icon icon-envelope"></span><span
											class="text">info@askasalla.com</span></a>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-md-12 text-center">

					<p><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
						AS KASALLA &copy;
						<script>document.write(new Date().getFullYear());</script> All rights reserved | Powered and
						secured by <a href="https://datasqware.com" target="_blank">Datasqware</a>
						<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
					</p>
				</div>
			</div>
		</div>
	</footer>

	<!-- loader -->
	<div id="ftco-loader" class="show fullscreen"><svg class="circular" width="48px" height="48px">
			<circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee" />
			<circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10"
				stroke="#F96D00" />
		</svg></div>

	<script>
		// Get the query parameters from the URL
		const urlParams = new URLSearchParams(window.location.search);

		// Access individual parameters using .get()
		const pickupLocation = urlParams.get('pickup_location');
		const dropoffLocation = urlParams.get('dropoff_location');
		const pickupDate = urlParams.get('pickup_date');
		const dropoffDate = urlParams.get('dropoff_date');
		const pickupTime = urlParams.get('pickup_time');
		const dropoffTime = urlParams.get('dropoff_time');

		// Funksioni për të kombinuar datën dhe orën dhe për të hequr 1 orë
		function combineDateAndTime(date, time) {
			const [month, day, year] = date.split('/'); // Shpërndarja e datës
			const [timeValue, meridiem] = time.match(/(\d{1,2}:\d{2})(am|pm)/i).slice(1); // Nxjerrja e orës dhe AM/PM

			const [hours, minutes] = timeValue.split(':').map(Number);
			const adjustedHours = meridiem.toLowerCase() === 'pm' && hours !== 12
				? hours + 12
				: meridiem.toLowerCase() === 'am' && hours === 12
					? 0
					: hours;

			const isoDate = `${year}-${month.padStart(2, '0')}-${day.padStart(2, '0')}`;
			const dateTime = new Date(`${isoDate}T${adjustedHours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:00`);

			if (isNaN(dateTime)) {
				throw new Error(`Invalid date or time: ${date} ${time}`);
			}

			dateTime.setHours(dateTime.getHours() + 1);
			return dateTime.toISOString();
		}

		const pickupDateTime = combineDateAndTime(pickupDate, pickupTime);
		const dropoffDateTime = combineDateAndTime(dropoffDate, dropoffTime);

		// Set values for pickup and dropoff locations
		document.getElementById('pickupLocation').value = pickupLocation || '';
		document.getElementById('dropoffLocation').value = dropoffLocation || '';

		// Set values for pickup and dropoff locations
		document.getElementById('book_pick_date').value = pickupDate || '';
		document.getElementById('book_off_date').value = dropoffDate || '';

		// document.getElementById('pickupTime').value = pickup_time || '';

		// Listen for click events on all "Book now" buttons
		document.addEventListener('click', function (event) {
			if (event.target.classList.contains('book-now-btn')) {

				const vehicleId = event.target.getAttribute('data-vehicle-id');
				const vehicleImg = event.target.getAttribute('data-vehicle-img');
				const vehicleName = event.target.getAttribute('data-vehicle-name');
				const vehicleModel = event.target.getAttribute('data-vehicle-model');
				const price = event.target.getAttribute('data-price');

				document.getElementById('vehicle_id').value = vehicleId || '';
				document.getElementById('vehicle_img').src = vehicleImg || '';
				document.getElementById('vehiclename').innerText = vehicleName || '';
				document.getElementById('vehiclemodel').innerText = vehicleModel || '';
				document.getElementById('price').value = price || '';
				document.getElementById('vehicleprice').innerText = price + " € / day" || '';

			}
		});

		// API key and URL construction
		const api_key = "8d5fd82d-99f4-46dc-8b58-3dab0442f048";
		const apiUrl = `https://api.auttom.io/reservations/public/get-availability/${new Date(pickupDate).toISOString()}/${new Date(dropoffDate).toISOString()}?api_key=${api_key}`;

		// Fetch data from API
		fetch(apiUrl)
			.then(response => response.json()) // Parse response as JSON
			.then(data => {
				const carRentalsContainer = document.getElementById('car-rentals');

				let cardsHTML = '<div class="row">';

				data.forEach(car => {

					cardsHTML += `
						<div class="col-md-4">
							<div class="car-wrap rounded">
								<div class="img rounded d-flex align-items-end" style="background-image: url('${car.cover_image || 'images/audi_a4.webp'}');">
								</div>
								<div class="text">
									<h2 class="mb-0"><a href="car-single.html" style="font-size: 18px;">${car.make.name || 'Rent a Car'} ${car.make_model ? car.make_model : ""}</a></h2>
									<div class="d-flex mb-3">
										<span class="cat" style="color: red; font-size: 16px;">${car.prices[0].base_price || 'Compact Sedan'} € / day</span>
									</div>
									<div>
										<div class="container text-center">
											<div class="row">
												<div class="col">
													<div class="icon d-flex align-items-center justify-content-center">
														<span class="flaticon-pistons"></span>
													</div>
													<p style="font-size: 9px;">${car.transmission || 'Automat'}</p>
												</div>
												<div class="col">
													<div class="icon d-flex align-items-center justify-content-center"><span class="flaticon-car-seat"></span>
													</div>
													<p style="font-size: 9px;">${car.seats || '5Adults'}</p>
												</div>
												<div class="col">
													<div class="icon d-flex align-items-center justify-content-center"><span class="flaticon-backpack"></span>
													</div>
													<p style="font-size: 9px;">${car.bags || '4Bags'}</p>
												</div>
											</div>
										</div>
									</div>
									<div>
										<a data-toggle="modal" data-vehicle-id="${car.id}" data-vehicle-img="${car.cover_image}"  data-vehicle-name="${car.make.name}" data-vehicle-model="${car.make_model}" data-price="${car.prices[0].base_price}" data-target="#bookNowModal" style="background-color: #141717; color: #fff; border-radius: 10px; margin-top: 10px;" class="btn book-now-btn py-2 mr-1">Book now</a>
									</div>
								</div>
							</div>
						</div>
					`;
				});

				cardsHTML += '</div>';

				carRentalsContainer.innerHTML = cardsHTML;
			})
			.catch(error => {
				console.error('Error fetching data:', error);
			});

		document
			.getElementById("bookingForm")
			.addEventListener("submit", async (event) => {
				event.preventDefault();

				const formData = new FormData(event.target);

				const diffInMs = new Date(formData.get("dropoffDate")) - new Date(formData.get("pickupDate"));

				const diffInDays = diffInMs / (1000 * 60 * 60 * 24);

				const data = {
					vehicle_id: Number(formData.get("vehicle_id")),
					full_name: formData.get("full_name"),
					phone_number: formData.get("phone_number"),
					pickup_date: new Date(combineDateAndTime(pickupDate, pickupTime)),
					dropoff_date: new Date(combineDateAndTime(dropoffDate, dropoffTime)),
					email: formData.get("email"),
					pickup_location_id: Number(formData.get("pickup_location")),
					dropoff_location_id: Number(
						formData.get("dropoff_location"),
					),
					amount: Number(formData.get("price")) * diffInDays,
				};

				const apiUrl = "https://api.auttom.io/reservations/public/add-booking?api_key=8d5fd82d-99f4-46dc-8b58-3dab0442f048";

				try {

					// Push the custom event to the dataLayer
					window.dataLayer = window.dataLayer || [];
					window.dataLayer.push({
						event: "form_submit",
						eventModel: {
							form_id: "bookingForm",
						},
					});
					// Make the API request
					const response = await fetch(apiUrl, {
						method: "POST",
						headers: {
							"Content-Type": "application/json",
						},
						body: JSON.stringify(data),
					});

					const responseMessage = document.getElementById("responseMessage");

					if (response.ok) {
						const result = await response.json();
						responseMessage.innerHTML = `<div class="alert alert-success">Your reservation request was successfully sent! Please check your email for the reservation status.</div>`;
						document.getElementById('full_name').value = '';
						document.getElementById('phone_number').value = '';
						document.getElementById('email').value = '';
					} else {
						const error = await response.json();
						responseMessage.innerHTML = `<div class="alert alert-danger">Booking failed: ${error.message}</div>`;
					}

				} catch (error) {
					console.error("Error:", error);
					document.getElementById("responseMessage").innerHTML =
						`<div class="alert alert-danger">An unexpected error occurred.</div>`;
				}
			});

	</script>

	<script src="../js/jquery.min.js"></script>
	<script src="../js/jquery-migrate-3.0.1.min.js"></script>
	<script src="../js/popper.min.js"></script>
	<script src="../js/bootstrap.min.js"></script>
	<script src="../js/jquery.easing.1.3.js"></script>
	<script src="../js/jquery.waypoints.min.js"></script>
	<script src="../js/jquery.stellar.min.js"></script>
	<script src="../js/owl.carousel.min.js"></script>
	<script src="../js/jquery.magnific-popup.min.js"></script>
	<script src="../js/aos.js"></script>
	<script src="../js/jquery.animateNumber.min.js"></script>
	<script src="../js/bootstrap-datepicker.js"></script>
	<script src="../js/jquery.timepicker.min.js"></script>
	<script src="../js/scrollax.min.js"></script>
	<script
		src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBVWaKrjvy3MaE7SQ74_uJiULgl1JY0H2s&sensor=false"></script>
	<script src="../js/google-map.js"></script>
	<script src="../js/main.js"></script>

</body>

</html>